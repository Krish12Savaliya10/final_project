<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TourGen | Create Account</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/signup.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
</head>
<body>
<button class="btn btn-outline-light btn-sm rounded-pill theme-toggle-float" type="button" data-theme-toggle>
  <i class="bi bi-moon-stars"></i> <span data-theme-label>Dark Mode</span>
</button>
<div class="signup-container">
  <div class="logo">TourGen</div>
  <div class="subtitle">Create your role-based account</div>

  <form method="POST" action="{{ url_for('signup') }}" enctype="multipart/form-data">

    <div class="input-group">
      <i class="bi bi-person"></i>
      <input type="text" name="full_name" value="{{ request.form.full_name }}" placeholder="Full Name" required>
    </div>
    {% if errors and errors.get('full_name') %}<div class="field-error">{{ errors['full_name'] }}</div>{% endif %}

    <div class="input-group">
      <i class="bi bi-envelope"></i>
      <input type="email" name="email" value="{{ request.form.email }}" placeholder="Email Address" required>
    </div>
    {% if errors and errors.get('email') %}<div class="field-error">{{ errors['email'] }}</div>{% endif %}

    <div class="input-group">
      <i class="bi bi-phone"></i>
      <input type="text" name="phone" value="{{ request.form.phone }}" placeholder="Mobile Number" required>
    </div>
    {% if errors and errors.get('phone') %}<div class="field-error">{{ errors['phone'] }}</div>{% endif %}

    <div class="input-group">
      <i class="bi bi-diagram-3"></i>
      <select name="role" id="roleSelect" required>
        <option value="traveler" {% if request.form.role == 'traveler' %}selected{% endif %}>Traveler</option>
        <option value="organizer" {% if request.form.role == 'organizer' %}selected{% endif %}>Organizer</option>
        <option value="provider" {% if request.form.role == 'provider' %}selected{% endif %}>Service Provider</option>
        <option value="admin" {% if request.form.role == 'admin' %}selected{% endif %}>Admin</option>
      </select>
    </div>

    <div class="doc-box" id="businessBox">
      <div class="input-group">
        <i class="bi bi-building"></i>
        <input type="text" name="business_name" value="{{ request.form.business_name }}" placeholder="Organization / Business Name">
      </div>
    </div>

    <div class="doc-box" id="providerCategoryBox">
      <div class="input-group">
        <i class="bi bi-briefcase"></i>
        <select name="provider_category">
          <option value="">Select service category</option>
          <option value="Hotel" {% if request.form.provider_category == 'Hotel' %}selected{% endif %}>Hotel</option>
          <option value="Transport" {% if request.form.provider_category == 'Transport' %}selected{% endif %}>Transport</option>
          <option value="Guides" {% if request.form.provider_category == 'Guides' %}selected{% endif %}>Guides</option>
          <option value="Food" {% if request.form.provider_category == 'Food' %}selected{% endif %}>Food</option>
        </select>
      </div>
      {% if errors and errors.get('provider_category') %}<div class="field-error">{{ errors['provider_category'] }}</div>{% endif %}
    </div>

    <div class="doc-box" id="documentBox">
      <div class="input-group doc-input-group">
        <i class="bi bi-file-earmark-arrow-up"></i>
        <input type="file" name="document" class="doc-file-input" accept=".pdf,.jpg,.jpeg,.png">
      </div>
      <div class="role-note">Organizer, Service Provider and Admin require document verification.</div>
      {% if errors and errors.get('document') %}<div class="field-error">{{ errors['document'] }}</div>{% endif %}
    </div>

    <div class="input-group">
      <i class="bi bi-lock"></i>
      <input type="password" name="password" placeholder="Password" required>
    </div>
    {% if errors and errors.get('password') %}<div class="field-error">{{ errors['password'] }}</div>{% endif %}

    <div class="input-group">
      <i class="bi bi-lock-fill"></i>
      <input type="password" name="confirm" placeholder="Confirm Password" required>
    </div>
    {% if errors and errors.get('confirm') %}<div class="field-error">{{ errors['confirm'] }}</div>{% endif %}

    <button class="signup-btn" type="submit">Create Account</button>

    <div class="login-link">
      Already have an account? <a href="{{ url_for('login') }}">Login</a>
    </div>
  </form>
</div>

<script>
function toggleRoleFields(){
  const role = document.getElementById('roleSelect').value;
  const needsDoc = role === 'organizer' || role === 'provider' || role === 'admin';
  document.getElementById('documentBox').style.display = needsDoc ? 'block' : 'none';
  document.getElementById('businessBox').style.display = needsDoc ? 'block' : 'none';
  document.getElementById('providerCategoryBox').style.display = role === 'provider' ? 'block' : 'none';
}

document.getElementById('roleSelect').addEventListener('change', toggleRoleFields);
toggleRoleFields();
</script>
<script src="{{ url_for('static', filename='js/theme.js') }}"></script>
</body>
</html>
