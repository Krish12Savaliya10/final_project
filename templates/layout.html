<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>{% block title %}TourGen{% endblock %}</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

<link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">

{% block extra_css %}{% endblock %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
</head>

<body>

<nav class="navbar navbar-expand-lg custom-navbar fixed-top">
<div class="container-xl">

<a class="navbar-brand brand-logo" href="{{ url_for('home') }}">
<i class="bi bi-compass"></i> TourGen
</a>

<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMenu" aria-controls="navMenu" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>

<div class="collapse navbar-collapse" id="navMenu">
<ul class="navbar-nav ms-auto align-items-lg-center align-items-stretch">

<li class="nav-item">
<a class="nav-link" href="{{ url_for('home') }}">Home</a>
</li>

<li class="nav-item">
<a class="nav-link" href="{{ url_for('tour') }}">Tours</a>
</li>

<li class="nav-item">
<a class="nav-link" href="{{ url_for('spots') }}">Spots</a>
</li>

<li class="nav-item">
<a class="nav-link" href="{{ url_for('hotels') }}">Hotels</a>
</li>

<li class="nav-item">
<a class="nav-link" href="{{ url_for('about') }}">About</a>
</li>

<li class="nav-item">
<a class="nav-link" href="{{ url_for('contact') }}">Contact</a>
</li>

{% if session.get('user_id') %}

<li class="nav-item position-relative">
<button type="button" class="profile-btn" onclick="toggleProfile()" aria-expanded="false" aria-controls="profileMenu">
<i class="bi bi-person-circle"></i> {{ session.username }}
</button>

<div id="profileMenu" class="profile-menu" role="menu" aria-hidden="true">

<div class="profile-head">
<small class="text-muted">Signed in as</small><br>
<strong>{{ session.username }}</strong>
</div>

<a href="{{ url_for('profile') }}">
<i class="bi bi-person-vcard"></i> My Profile
</a>

<a href="{{ url_for('feedback') }}">
<i class="bi bi-chat-square-text"></i> Feedback & Issues
</a>

<button type="button" class="profile-menu-action" data-theme-toggle>
<i class="bi bi-moon-stars"></i> <span data-theme-label>Dark Mode</span>
</button>

{% if session.get('role') == 'customer' %}
<a href="{{ url_for('mybookings') }}">
<i class="bi bi-ticket-perforated"></i> My Bookings
</a>
{% endif %}

{% if session.get('role') == 'organizer' %}
<a href="{{ url_for('organizer_dashboard') }}">
<i class="bi bi-kanban"></i> Organizer Panel
</a>
{% endif %}

{% if session.get('role') == 'hotel_provider' %}
<a href="{{ url_for('provider_dashboard') }}">
<i class="bi bi-briefcase"></i> Hotel & Services Dashboard
</a>
{% endif %}

{% if session.get('role') == 'admin' %}
<a href="{{ url_for('admin') }}">
<i class="bi bi-shield-check"></i> Admin Dashboard
</a>
{% endif %}

<a href="{{ url_for('logout') }}" class="text-danger">
<i class="bi bi-box-arrow-right"></i> Logout
</a>

</div>
</li>

{% else %}
<li class="nav-item">
<a class="btn btn-login" href="{{ url_for('login') }}">Login / Signup</a>
</li>
{% endif %}

</ul>
</div>
</div>
</nav>

<div class="main-wrapper {% block wrapper_class %}{% endblock %}">
{% block content %}{% endblock %}
</div>

<footer>
Â© 2026 TourGen | Created by Krish Savaliya
</footer>

<script>
function toggleProfile(){
const menu = document.getElementById("profileMenu");
const trigger = document.querySelector(".profile-btn");
if(!menu || !trigger) return;
const isOpen = menu.classList.contains("show");
menu.classList.toggle("show", !isOpen);
menu.setAttribute("aria-hidden", isOpen ? "true" : "false");
trigger.setAttribute("aria-expanded", isOpen ? "false" : "true");
}

document.addEventListener("click",function(e){
if(!e.target.closest(".profile-btn") && !e.target.closest("#profileMenu")){
const menu = document.getElementById("profileMenu");
const trigger = document.querySelector(".profile-btn");
if(menu){
menu.classList.remove("show");
menu.setAttribute("aria-hidden", "true");
}
if(trigger){
trigger.setAttribute("aria-expanded", "false");
}
}
});

document.addEventListener("keydown", function(e){
if(e.key !== "Escape") return;
const menu = document.getElementById("profileMenu");
const trigger = document.querySelector(".profile-btn");
if(menu){
menu.classList.remove("show");
menu.setAttribute("aria-hidden", "true");
}
if(trigger){
trigger.setAttribute("aria-expanded", "false");
}
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/theme.js') }}"></script>
</body>
</html>
