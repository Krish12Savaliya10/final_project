<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TourGen | My Bookings</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

<style>

body{
    background:#f1f5f9;
    padding-top:85px;
    font-family:'Segoe UI',system-ui,sans-serif;
}

/* NAVBAR */
.custom-navbar{
    background:#0f172a;
}

.brand{
    font-weight:700;
    font-size:22px;
}

/* CARD */
.booking-card{
    border-radius:20px;
    border:none;
    transition:.25s;
}

.booking-card:hover{
    transform:translateY(-4px);
    box-shadow:0 12px 25px rgba(0,0,0,.12);
}

.status-paid{
    background:#16a34a;
    color:white;
    padding:8px 16px;
    border-radius:40px;
}

.status-pending{
    background:#f59e0b;
    color:white;
    padding:8px 16px;
    border-radius:40px;
}

</style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top custom-navbar">
<div class="container">

<a class="navbar-brand brand" href="{{ url_for('home') }}">
<i class="bi bi-compass"></i> TourGen
</a>

<div class="ms-auto">
<span class="text-white me-3">ðŸ‘‹ {{ session.username }}</span>
<a href="{{ url_for('home') }}" class="btn btn-outline-light btn-sm rounded-pill px-3">Home</a>
<a href="{{ url_for('logout') }}" class="btn btn-danger btn-sm rounded-pill px-3 ms-2">Logout</a>
</div>

</div>
</nav>

<div class="container pb-5">

<div class="d-flex justify-content-between align-items-center mb-4">
<h2 class="fw-bold"><i class="bi bi-luggage-fill text-primary"></i> My Trips</h2>
<span class="text-muted">{{ bookings|length }} bookings</span>
</div>

{% with messages = get_flashed_messages() %}
{% if messages %}
<div class="alert alert-success rounded-pill px-4">{{ messages[0] }}</div>
{% endif %}
{% endwith %}

<div class="row g-4">

{% for b in bookings %}
<div class="col-12">

<div class="card booking-card shadow-sm p-4">

<div class="row align-items-center">

<div class="col-md-6">
<h4 class="fw-bold mb-1">{{ b.title }}</h4>
<p class="text-muted small">Travel Date: {{ b.start_date }}</p>
<p class="text-muted small">Booked On: {{ b.date }}</p>

<div class="mt-2">
<span class="badge bg-light text-dark border p-2">
<i class="bi bi-credit-card"></i> â‚¹{{ b.price }}
</span>
</div>
</div>

<div class="col-md-6 text-md-end mt-3 mt-md-0">

{% if b.status == 'paid' %}
<span class="status-paid me-3">
<i class="bi bi-check-circle"></i> Confirmed
</span>
{% else %}
<span class="status-pending me-3">
<i class="bi bi-hourglass-split"></i> Payment Pending
</span>

<a href="{{ url_for('payment', booking_id=b.id) }}"
   class="btn btn-primary rounded-pill px-4 fw-bold">
Complete Payment
</a>
{% endif %}

<br class="d-md-none"><br class="d-md-none">

<a href="{{ url_for('booking', tour_id=b.tour_id) }}"
   class="btn btn-outline-secondary rounded-pill px-4 mt-2">
View Plan
</a>

<a href="{{ url_for('invoice', booking_id=b.id) }}"
   class="btn btn-dark rounded-pill px-4 mt-2">
<i class="bi bi-download"></i> Bill
</a>

</div>

</div>
</div>

</div>
{% else %}

<div class="col-12 text-center py-5">
<i class="bi bi-calendar-x display-1 text-muted"></i>
<h3 class="mt-4 text-muted">No bookings yet</h3>
<a href="{{ url_for('tour') }}" class="btn btn-primary btn-lg rounded-pill mt-3 px-5">
Explore Tours
</a>
</div>

{% endfor %}

</div>
</div>

</body>
</html>