<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TourGen | Admin Panel</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
</head>

<body>

<!-- SIDEBAR -->
<nav id="sidebar">
<ul class="nav flex-column gap-2">
<li><a onclick="showSection('dashboard', this)" class="nav-link active">
<i class="bi bi-grid-1x2-fill me-2"></i> Analytics</a></li>

<li><a onclick="showSection('bookings', this)" class="nav-link">
<i class="bi bi-person-badge-fill me-2"></i> User Bookings</a></li>

<li><hr class="text-secondary mx-3"></li>

<li><a href="{{ url_for('home') }}" class="nav-link">
<i class="bi bi-box-arrow-up-right me-2"></i> Live Website</a></li>
</ul>
</nav>

<!-- MAIN CONTENT -->
<div id="main-content">

<nav class="navbar navbar-dark bg-dark fixed-top shadow">
<div class="container-fluid px-4">
<a class="navbar-brand fw-bold"><i>TourGen</i> Admin</a>
<a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm">Logout</a>
</div>
</nav>

<!-- DASHBOARD -->
<div id="dashboard" class="section-content active">

<div class="d-flex justify-content-between align-items-center mb-4">
<h3 class="fw-bold">Inventory & Stats</h3>

<button class="btn btn-primary rounded-pill px-4"
data-bs-toggle="modal" data-bs-target="#addTourModal">
<i class="bi bi-plus-lg me-2"></i>Add Package
</button>
</div>

<div class="row g-4 mb-5">
<div class="col-md-6">
<div class="card p-4">
<small class="text-muted fw-bold">TOTAL PACKAGES</small>
<h2 class="fw-bold mt-1">{{ tours|length }}</h2>
</div>
</div>

<div class="col-md-6">
<div class="card p-4">
<small class="text-muted fw-bold">CONFIRMED BOOKINGS</small>
<h2 class="fw-bold mt-1 text-primary">{{ bookings|length }}</h2>
</div>
</div>
</div>

<!-- TOUR TABLE -->
<div class="card border-0">
<div class="p-3 border-bottom"><h5 class="mb-0 fw-bold">Active Tour Packages</h5></div>
<div class="table-responsive">

<table class="table align-middle">
<thead class="bg-light text-muted">
<tr>
<th class="ps-4">Tour</th>
<th>Description</th>
<th>Price</th>
</tr>
</thead>

<tbody>
{% for tour in tours %}
<tr>
<td class="ps-4 fw-bold">{{ tour.title }}</td>
<td>{{ tour.description }}</td>
<td class="text-primary fw-bold">â‚¹{{ tour.price }}</td>
</tr>
{% endfor %}
</tbody>

</table>
</div>
</div>
</div>

<!-- BOOKINGS -->
<div id="bookings" class="section-content">
<h3 class="fw-bold mb-4">Customer Orders</h3>

<div class="card border-0">
<div class="table-responsive">

<table class="table align-middle mb-0">
<thead class="bg-light">
<tr>
<th class="ps-4">User</th>
<th>Tour</th>
<th>Status</th>
</tr>
</thead>

<tbody>
{% for b in bookings %}
<tr>
<td class="ps-4">{{ b.username }}</td>
<td>{{ b.title }}</td>
<td><span class="badge bg-success">{{ b.status }}</span></td>
</tr>
{% endfor %}
</tbody>

</table>
</div>
</div>
</div>

</div>

<!-- ADD TOUR MODAL -->
<div class="modal fade" id="addTourModal" tabindex="-1">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content border-0 shadow-lg p-3" style="border-radius:20px;">

<form method="POST" action="{{ url_for('admin') }}">
<h5 class="fw-bold mb-4">New Tour Details</h5>

<input type="text" name="title" class="form-control mb-3" placeholder="Destination Name" required>
<textarea name="description" class="form-control mb-3" placeholder="Description" required></textarea>
<input type="number" name="price" class="form-control mb-3" placeholder="Price" required>

<button type="submit" class="btn btn-primary w-100 rounded-pill py-2 fw-bold shadow">
Publish Tour
</button>

</form>
</div>
</div>
</div>

<script>
function showSection(id, btn){
document.querySelectorAll('.section-content').forEach(s=>s.classList.remove('active'));
document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));
document.getElementById(id).classList.add('active');
btn.classList.add('active');
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
